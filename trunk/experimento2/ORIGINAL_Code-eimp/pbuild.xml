<?xml version="1.0" encoding="UTF-8"?>
<project basedir="." name="org.maze.eimp" default="all">

<property name="dir.src" location="${basedir}/src"></property>
<property name="dir.build.java" location="${basedir}/bin"></property>
<property name="dir.src" location="${basedir}/src"></property>
<property name="version.eimp" value="1.0"></property>
<property name="version.app" value="1.0"></property>
<property name="version.eclipse" value="3.0.0"></property>

<property name="app.name" value="eimp"></property>
<property name="app.zip.name" value="${app.name}-${version.app}_win32.zip"></property>
<property name="app.gz.name" value="${app.name}-${version.app}.tar.gz"></property>
<property name="app.bz2.name" value="${app.name}-${version.app}.tar.bz2"></property>

<property name="app.lnx.gtk.zip.name" value="${app.name}-${version.app}_linux_gtk.zip"></property>
<property name="src.zip.name" value="${app.name}-${version.eimp}.src.zip"></property>
<property name="app.gz.name" value="${app.name}-${version.app}.tar.gz"></property>
<property name="app.bz2.name" value="${app.name}-${version.app}.tar.bz2"></property>

<!-- property name="dir.eclipse" location="D:\app\dev\eclipse"></property -->
<property name="dir.eclipse" location="E:\app\dev\eclipse"></property>

<target name="all" depends="dist-zip,dist-tar,dist-app-zip-linux-gtk,dist-app-zip-win32,dist-app-src">

</target>

<target name="nls">
<delete dir="${dir.build.java}" includes="**/*_zh_CN.properties"></delete>
<native2ascii encoding="GBK" src="${dir.src}" dest="${dir.build.java}"
   includes="**/*_zh_CN.properties" ext=".properties"/>
</target>

<target name="jar" depends="nls">
<jar destfile="${basedir}/eimp.jar"
       basedir="${dir.build.java}"
/>
</target>

<target name="dist-tar" depends="jar">
<tar destfile="${basedir}/eimp-${version.eimp}.tar">
<tarfileset dir="${basedir}/icons" prefix="${ant.project.name}_${version.eimp}/icons"/>
<tarfileset dir="${basedir}/lib" prefix="${ant.project.name}_${version.eimp}/lib"/>
<tarfileset dir="${basedir}" includes="eimp.jar" fullpath="${ant.project.name}_${version.eimp}/eimp.jar"/>
<tarfileset dir="${basedir}" includes="plugin.xml" fullpath="${ant.project.name}_${version.eimp}/plugin.xml"/>
</tar>
<gzip zipfile="${basedir}/eimp-${version.eimp}.tar.gz" src="${basedir}/eimp-${version.eimp}.tar"/>
<bzip2 zipfile="${basedir}/eimp-${version.eimp}.tar.bz2" src="${basedir}/eimp-${version.eimp}.tar"/>
</target>

<target name="dist-zip" depends="jar">
<zip destfile="eimp-${version.eimp}.zip">
<zipfileset dir="${basedir}/icons" prefix="${ant.project.name}_${version.eimp}/icons"/>
<zipfileset dir="${basedir}/lib" prefix="${ant.project.name}_${version.eimp}/lib"/>
<zipfileset dir="${basedir}" includes="eimp.jar" fullpath="${ant.project.name}_${version.eimp}/eimp.jar"/>
<zipfileset dir="${basedir}" includes="plugin.xml" fullpath="${ant.project.name}_${version.eimp}/plugin.xml"/>
</zip>
</target>

<target name="dist-app-src">
<zip destfile="${src.zip.name}">
<zipfileset dir="${basedir}/icons" prefix="${app.name}/icons"/>
<zipfileset dir="${basedir}/src" prefix="${app.name}/src"/>
<zipfileset dir="${basedir}/lib" prefix="${app.name}/lib"/>
<zipfileset dir="${basedir}/navlib" includes="systray4j.dll" fullpath="${app.name}/navlib/systray4j.dll"/>
<zipfileset dir="${basedir}/bash" prefix="${app.name}/bash"/>
<zipfileset dir="${basedir}" includes="*.TXT"  prefix="${app.name}/" />
<zipfileset dir="${basedir}" includes="*.xml" prefix="${app.name}/" />
</zip>
</target>

<target name="dist-app-zip-win32" depends="jar">
<zip destfile="${app.zip.name}">
<zipfileset dir="${basedir}/icons" prefix="${app.name}/icons"/>
<zipfileset dir="${basedir}/lib" prefix="${app.name}/lib"/>
<zipfileset dir="${basedir}/swt/win32" includes="swt.jar" prefix="${app.name}/lib"/>
<zipfileset dir="${basedir}/jface" prefix="${app.name}/lib"/>
<zipfileset dir="${basedir}/navlib" includes="systray4j.dll" fullpath="${app.name}/systray4j.dll"/>
<zipfileset dir="${basedir}/swt/win32" includes="swt-win32-*.dll" prefix="${app.name}/"/>
<zipfileset dir="${basedir}/bash" prefix="${app.name}/"/>
<zipfileset dir="${basedir}" includes="ABOUTME.TXT" fullpath="${app.name}/ABOUTME.TXT"/>
<zipfileset dir="${basedir}" includes="eimp.jar" fullpath="${app.name}/eimp.jar"/>
</zip>
</target> 

<target name="dist-app-zip-linux-gtk" depends="jar">
<zip destfile="${app.lnx.gtk.zip.name}">
<zipfileset dir="${basedir}/icons" prefix="${app.name}/icons"/>
<zipfileset dir="${basedir}/lib" prefix="${app.name}/lib"/>
<zipfileset dir="${basedir}/swt/lnx-gtk" includes="*.jar" prefix="${app.name}/lib"/>
<zipfileset dir="${basedir}/jface" includes="*.jar" prefix="${app.name}/lib"/>
<zipfileset dir="${basedir}/swt/lnx-gtk" includes="libswt-*.so" prefix="${app.name}/"/>
<zipfileset dir="${basedir}/bash" prefix="${app.name}/"/>
<zipfileset dir="${basedir}" includes="ABOUTME.TXT" fullpath="${app.name}/ABOUTME.TXT"/>
<zipfileset dir="${basedir}" includes="eimp.jar" fullpath="${app.name}/eimp.jar"/>
</zip>
</target> 

<target name="upload-cosoft">
<ftp server="ftp.cosoft.org.cn"
       remotedir="/incoming"
       userid="anonymous"
       password="me@myorg.com"
       depends="yes"
  >
    <fileset dir="${basedir}" includes="eimp-${version.eimp}.zip"/>
    <fileset dir="${basedir}" includes="eimp-${version.eimp}.tar.gz"/>
</ftp>
</target>

<target name="upload-sourceforge">
<ftp server="upload.sourceforge.net"
       remotedir="/incoming"
       userid="anonymous"
       password="me@myorg.com"
       depends="yes"
  >
    <fileset dir="${basedir}" includes="eimp-${version.eimp}.zip"/>
    <fileset dir="${basedir}" includes="eimp-${version.eimp}.tar.gz"/>
</ftp>
</target>

<target name="clear">
<delete file="eimp.jar"></delete>
<delete file="eimp-${version.eimp}.zip"></delete>
<delete file="eimp-${version.eimp}.tar"></delete>
<delete file="eimp-${version.eimp}.tar.gz"></delete>
<delete file="eimp-${version.eimp}.tar.bz2"></delete>
</target>


</project>